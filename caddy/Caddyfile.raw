{
  admin off
  log {
      output file /var/log/caddy/access.log 
      level INFO 
  } 
  servers :443 { 
      protocols h1 h2
  } 
}

:80 {
    redir https://{host}{uri} permanent
}

#NaiveProxy
:443, abc.com {
  tls xxx@x.com
  encode gzip
  route {
    forward_proxy {
        basic_auth superuser passwd
        hide_ip
        hide_via
        probe_resistance randomDomain.com  #Modify to a secret domain, like password
    }
    file_server {
        root /usr/share/caddy
    }
  }
}

:9992 {
  file_server {
        root /usr/share/caddy
        browse
    }
}

#Docker
abc.com {
    tls xxx@x.com
    encode gzip
    reverse_proxy http://127.0.0.1:35080 {
        header_up X-Forwarded-Proto https
        header_up Host {host}
    }
}

# ZeroTier
abc.com {
    tls xxx@x.com
    encode gzip
    reverse_proxy http://127.0.0.1:3000 {
        header_up X-Forwarded-Proto https
        header_up Host {host}
    }                                                                                        
}

# Trojan 
abc.com {
    reverse_proxy 127.0.0.1:14589
    }
